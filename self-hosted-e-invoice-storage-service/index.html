<!doctype html><html lang=zh-tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>自建電子發票儲存服務 - 勝勝</title><meta name=description content="在 APP 商店有很多發票的 APP，但大部分的都會儲存你資料進行分析，從發票資料中，甚至可以知道你平常在哪消費等資訊，可以參考這篇文章：從 API 串接角度評估電子發票存摺 APP 可以怎樣出賣使用者個資
我真的沒有想繼續把資料賣給這些廠商，所以開發了一個發票儲存服務，我已經包成 Docker 格式，只要你有相關的經驗，應該能夠在十分鐘內架設好這個服務。
修改密碼 為了避免原本的發票 APP 繼續取得你的發票資訊，建議你可以把密碼改掉後再進行下面的步驟，你可以到 財政部電子發票整合服務平台 做這件事
架設 NocoDB NocoDB 是一款資料庫的介面軟體，可以透過他查看資料庫內的資料，可以連接現有的資料庫，或是使用內建的 SQLite 來作為資料庫，可以參考 官方的部署指南 來了解如何部署。
在 NocoDB 建立 API Key 和取得 Base ID 這是等一下會用到的妙妙工具
架設 nocodb-einvoice NocoDB einvoice 是由我開發的發票匯入工具，可以設定成每天自動執行把發票資料匯入到 NocoDB，你可以參考 README 文件 來了解如何架設
環境變數 必填  NOCODB_URL: NocoDB 的 URL NOCODB_API_KEY: NocoDB 的 API Key NOCODB_BASE_ID: NocoDB 的 Base ID （可以在瀏覽器的網址列中找到） EINVOICE_USERNAME: 電子發票的帳號（電話號碼） EINVOICE_PASSWORD: 電子發票的密碼（又稱驗證碼）  選填  CRON_SCHEDULE  預設值：0 3 * * *，每天凌晨 3 點執行 可參考 crontab."><meta name=author content="勝勝"><link href=https://blog.gnehs.net/an-old-hope.min.css rel=stylesheet><link href=https://blog.gnehs.net/style.css rel=stylesheet><link href=https://blog.gnehs.net/custom.css rel=stylesheet><link rel=apple-touch-icon href=/favicon.png><link rel=icon href=/favicon.png><meta name=generator content="Hugo 0.81.0"><meta property="og:title" content="自建電子發票儲存服務"><meta property="og:description" content="在 APP 商店有很多發票的 APP，但大部分的都會儲存你資料進行分析，從發票資料中，甚至可以知道你平常在哪消費等資訊，可以參考這篇文章：從 API 串接角度評估電子發票存摺 APP 可以怎樣出賣使用者個資
我真的沒有想繼續把資料賣給這些廠商，所以開發了一個發票儲存服務，我已經包成 Docker 格式，只要你有相關的經驗，應該能夠在十分鐘內架設好這個服務。
修改密碼 為了避免原本的發票 APP 繼續取得你的發票資訊，建議你可以把密碼改掉後再進行下面的步驟，你可以到 財政部電子發票整合服務平台 做這件事
架設 NocoDB NocoDB 是一款資料庫的介面軟體，可以透過他查看資料庫內的資料，可以連接現有的資料庫，或是使用內建的 SQLite 來作為資料庫，可以參考 官方的部署指南 來了解如何部署。
在 NocoDB 建立 API Key 和取得 Base ID 這是等一下會用到的妙妙工具
架設 nocodb-einvoice NocoDB einvoice 是由我開發的發票匯入工具，可以設定成每天自動執行把發票資料匯入到 NocoDB，你可以參考 README 文件 來了解如何架設
環境變數 必填  NOCODB_URL: NocoDB 的 URL NOCODB_API_KEY: NocoDB 的 API Key NOCODB_BASE_ID: NocoDB 的 Base ID （可以在瀏覽器的網址列中找到） EINVOICE_USERNAME: 電子發票的帳號（電話號碼） EINVOICE_PASSWORD: 電子發票的密碼（又稱驗證碼）  選填  CRON_SCHEDULE  預設值：0 3 * * *，每天凌晨 3 點執行 可參考 crontab."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.gnehs.net/self-hosted-e-invoice-storage-service/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-16T16:16:35+08:00"><meta property="article:modified_time" content="2025-02-16T16:16:35+08:00"><meta property="og:image" content="https://blog.gnehs.net/img/self-hosted-e-invoice-storage-service.png"><meta name=twitter:card content="summary_large_image"><script>function setTheme(){if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');return}const c=new Date,g=localStorage.getItem('date'),d=String(c.getMonth()+1)+'.'+String(c.getDate()),e=c.getTime();let a,b;function f(){if(e>a&&e<b)return;document.body.classList.add('dark')}d!==g?(fetch('https://api.ipgeolocation.io/astronomy?apiKey=5ed37d85103e4defa5df4c5298ed5215').then(a=>a.json()).then(c=>{a=c.sunrise.split(':').map(Number),b=c.sunset.split(':').map(Number)}).catch(()=>{a=[7,0],b=[19,0]}).finally(()=>{a=c.setHours(a[0],a[1],0),b=c.setHours(b[0],b[1],0),f(),localStorage.setItem('sunrise',a),localStorage.setItem('sunset',b)}),localStorage.setItem('date',d)):(a=Number(localStorage.getItem('sunrise')),b=Number(localStorage.getItem('sunset')),f())}</script></head><body class=single><script>setTheme()</script><header class=header><nav class=nav><p class=logo><a href=https://blog.gnehs.net>勝勝</a></p><ul class=menu><li><a href=/invite-codes/>邀請碼</a></li><li><a href=/categories/>分類</a></li><li><a href=/about/>關於</a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>自建電子發票儲存服務</h1><div class=post-meta>勝勝 · 2025 年 02 月 16 日</div></header><div class=overtime-alert style=display:none>⚠️ 本篇文章距離撰寫時間已超過兩年，部分資訊可能已過時。</div><script>let modifiedTime=new Date(document.querySelector('meta[property="article:modified_time"]').getAttribute('content'));(new Date).getTime()-modifiedTime.getTime()>1e3*60*60*24*365*2&&(document.querySelector('.overtime-alert').style.display='block')</script><div class=post-content><p><img src=/img/self-hosted-e-invoice-storage-service/399413837-7146aa39-1938-4c05-955f-4b021b3e90b7.png alt></p><p>在 APP 商店有很多發票的 APP，但大部分的都會儲存你資料進行分析，從發票資料中，甚至可以知道你平常在哪消費等資訊，可以參考這篇文章：<a href=https://blog.user.today/invoice-api-problem/>從 API 串接角度評估電子發票存摺 APP 可以怎樣出賣使用者個資</a></p><p>我真的沒有想繼續把資料賣給這些廠商，所以開發了一個發票儲存服務，我已經包成 Docker 格式，只要你有相關的經驗，應該能夠在十分鐘內架設好這個服務。</p><h1 id=修改密碼>修改密碼</h1><p>為了避免原本的發票 APP 繼續取得你的發票資訊，建議你可以把密碼改掉後再進行下面的步驟，你可以到 <a href=https://www.einvoice.nat.gov.tw/>財政部電子發票整合服務平台</a> 做這件事</p><h1 id=架設-nocodb>架設 NocoDB</h1><p>NocoDB 是一款資料庫的介面軟體，可以透過他查看資料庫內的資料，可以連接現有的資料庫，或是使用內建的 SQLite 來作為資料庫，可以參考 <a href=https://docs.nocodb.com/getting-started/self-hosted/installation/docker-install>官方的部署指南</a> 來了解如何部署。</p><h1 id=在-nocodb-建立-api-key-和取得-base-id>在 NocoDB 建立 API Key 和取得 Base ID</h1><p>這是等一下會用到的妙妙工具</p><h1 id=架設-nocodb-einvoice>架設 nocodb-einvoice</h1><p>NocoDB einvoice 是由我開發的發票匯入工具，可以設定成每天自動執行把發票資料匯入到 NocoDB，你可以參考 <a href=https://github.com/gnehs/nocodb-einvoice>README 文件</a> 來了解如何架設</p><h2 id=環境變數>環境變數</h2><h3 id=必填>必填</h3><ul><li><code>NOCODB_URL</code>: NocoDB 的 URL</li><li><code>NOCODB_API_KEY</code>: NocoDB 的 API Key</li><li><code>NOCODB_BASE_ID</code>: NocoDB 的 Base ID （可以在瀏覽器的網址列中找到）</li><li><code>EINVOICE_USERNAME</code>: 電子發票的帳號（電話號碼）</li><li><code>EINVOICE_PASSWORD</code>: 電子發票的密碼（又稱驗證碼）</li></ul><h3 id=選填>選填</h3><ul><li><code>CRON_SCHEDULE</code><ul><li>預設值：<code>0 3 * * *</code>，每天凌晨 3 點執行</li><li>可參考 <a href=https://crontab.guru/>crontab.guru</a> 了解如何設定</li></ul></li><li><code>MAX_SYNC_MONTHS</code><ul><li>預設值：無限制</li><li>同步的最大月份，預設同步可查詢到的全部發票，建議在首次同步後設定此值為 <code>3</code>，以避免同步過多資料造成電子發票系統的負擔</li></ul></li><li><code>REQUEST_DELAY</code><ul><li>預設值：<code>1000</code> 毫秒，即 1 秒</li><li>每個請求之間的延遲（毫秒），避免造成電子發票系統的負擔</li></ul></li></ul><h2 id=在-docker-上部署>在 Docker 上部署</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker run -d --name nocodb-einvoice <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -e NOCODB_URL<span style=color:#f92672>=</span>https://&lt;HOST&gt;:&lt;PORT&gt; <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -e NOCODB_API_KEY<span style=color:#f92672>=</span>your-api-key <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -e NOCODB_BASE_ID<span style=color:#f92672>=</span>your-base-id <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -e EINVOICE_USERNAME<span style=color:#f92672>=</span>your-username <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -e EINVOICE_PASSWORD<span style=color:#f92672>=</span>your-password <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -e CRON_SCHEDULE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0 3 * * *&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  ghcr.io/gnehs/nocodb-einvoice:latest
</code></pre></div><h1 id=完成>完成</h1><p>如果設定沒錯的話，你應該會在 nocodb-einvoice 的 log 看到同步的相關日誌，另外程式將自動建立相關資料表，請不要修改資料表與欄位名稱</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>3:00:10 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> 測試驗證碼：84585
3:00:15 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> 登入成功
3:00:15 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> 正在同步 <span style=color:#ae81ff>2025</span> 年 <span style=color:#ae81ff>2</span> 月發票
3:00:17 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> - 正在取得第 1/1 頁發票
3:00:19 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> - 發票 KJXXXXXXXX 新增成功
3:00:21 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> - 發票 KGXXXXXXXX 新增成功
3:00:22 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> 正在同步 <span style=color:#ae81ff>2025</span> 年 <span style=color:#ae81ff>1</span> 月發票
3:00:24 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> - 正在取得第 1/1 頁發票
3:00:24 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> 正在同步 <span style=color:#ae81ff>2024</span> 年 <span style=color:#ae81ff>12</span> 月發票
3:00:26 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> - 正在取得第 1/1 頁發票
3:00:27 AM <span style=color:#f92672>[</span>發票<span style=color:#f92672>]</span> 同步完成
</code></pre></div><p>接下來發票工具就會根據你設定的排程自動進行匯入了</p><h1 id=載具小工具>載具小工具</h1><p>iOS 的朋友可以透過 <a href=https://skog-einvoice.gnehs.net/>斯揪發票</a> 小工具來產生載具圖片，並搭配 <a href=https://apps.apple.com/tw/app/widgetsmith/id1523682319>Widgetsmith</a> 放置圖片小工具在桌面喔</p><p><img src=/img/self-hosted-e-invoice-storage-service/skog-einvoice.jpeg alt></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.gnehs.net/tags/%E7%99%BC%E7%A5%A8>發票</a></li></ul></footer><br><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-6834090314855499 data-ad-slot=2767030263></ins></article></main><footer class=footer><span>&copy; 2017-2025 <a href=https://gnehs.net/>勝勝</a>可愛</span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</span>
<span>&#183;</span>
<span>Theme️ <a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper</a></span></footer><script src=https://blog.gnehs.net/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-96NRMGGV7E"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-96NRMGGV7E')</script></body></html>